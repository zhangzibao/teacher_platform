{"remainingRequest":"G:\\vue\\Admin\\teacher_platform\\node_modules\\babel-loader\\lib\\index.js!G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!G:\\vue\\Admin\\teacher_platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\vue\\Admin\\teacher_platform\\src\\views\\teacher_calendar\\teacher_calendar.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\vue\\Admin\\teacher_platform\\src\\views\\teacher_calendar\\teacher_calendar.vue","mtime":1551108181283},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1545539497453},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1545539518738},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1545539497453},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1545539518738}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Vue from \"vue\";\nimport { User } from '@/model';\nimport course_select from \"../../components/select_course.vue\";\nimport preview from \"../../components/preview.vue\";\nimport XDoc from \"../../assets/js/xdoc.js\";\nimport Bus from '../../assets/js/Bus.js';\nexport default {\n  data: function data() {\n    return {\n      steps: 0,\n      loading: true,\n      dialogVisible: false,\n      user_id: '',\n      currentPage: 1,\n      pageSize: 8,\n      itemTotal: 0,\n      NowDate: \"\",\n      form: {\n        start_school_year: \"2018\",\n        end_school_year: \"2019\",\n        term_num: 2,\n        course_name: \"面向对象课程设计\",\n        course_code: \"B014019\",\n        course_character: \"专业选修课\",\n        teacher_name: \"尹天鹤\",\n        major: \"信息与计算科学\",\n        course_class: \"171-1，2\",\n        start_teach_week: 1,\n        end_teach_week: 16,\n        is_weekly: true\n      },\n      teacher_calendar_rules: {\n        start_school_year: [{\n          required: true,\n          message: '请输入开始年份',\n          trigger: 'blur'\n        }],\n        end_school_year: [{\n          required: true,\n          message: '请输入结束年份',\n          trigger: 'blur'\n        }],\n        term_num: [{\n          required: true,\n          message: '请输入学期数',\n          trigger: 'blur'\n        }],\n        course_name: [{\n          required: false,\n          message: '请输入课程名称',\n          trigger: 'blur'\n        }],\n        course_code: [{\n          required: false,\n          message: '请输入课程编码',\n          trigger: 'blur'\n        }],\n        course_character: [{\n          required: false,\n          message: '请输入课程性质',\n          trigger: 'blur'\n        }],\n        teacher_name: [{\n          required: false,\n          message: '请输入教师名称',\n          trigger: 'blur'\n        }],\n        major: [{\n          required: false,\n          message: '请输入专业',\n          trigger: 'blur'\n        }],\n        course_class: [{\n          required: false,\n          message: '请输入任课班级',\n          trigger: 'blur'\n        }],\n        start_teach_week: [{\n          required: true,\n          message: '请输入教学开始周',\n          trigger: 'blur'\n        }],\n        end_teach_week: [{\n          required: true,\n          message: '请输入教学结束周',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  components: {\n    course_select: course_select,\n    preview: preview\n  },\n  methods: {\n    exportDocx: function exportDocx() {\n      var table = \"周次,月.日,讲课内容分章、分节名称,时数,实验、讨论课、习题课等环节名称,时数,作业\\n\";\n      this.$store.state.weekInfo.forEach(function (val) {\n        table = table + val.weekNum + \",\" + val.classDay + \"\\n\";\n      });\n      var params = {\n        _filename: this.form.teacher_name + \"-\" + this.form.course_name + \"-教学日历\",\n        \"course_name\": this.form.course_name,\n        \"course_code\": this.form.course_code,\n        \"course_character\": this.form.course_character,\n        \"major\": this.form.major,\n        \"class\": this.form.course_class,\n        \"start_school_year\": this.form.start_school_year,\n        \"end_school_year\": this.form.end_school_year,\n        \"term_num\": this.form.term_num,\n        \"teacher_name\": this.form.teacher_name,\n        \"date\": this.NowDate,\n        \"list\": \"教学周数,讲课,实验等,机动,合计,培养方案\\n\" + (this.form.end_teach_week - this.form.start_teach_week + 1) + \"周,,,,,\",\n        \"table\": table\n      };\n      this.steps++;\n      XDoc.server = \"http://www.xdocin.com\";\n      XDoc.key = \"3vxgddieardwtmzuadxxavx4ha\";\n      XDoc.run(\"./yintianhe.xdoc\", \"docx\", params, \"_blank\");\n      this.$message({\n        message: '导出成功',\n        type: 'success'\n      });\n    },\n    setEndYear: function setEndYear() {\n      this.form.end_school_year = parseInt(this.form.start_school_year) + 1 + \"\";\n    },\n    prevStep: function prevStep() {\n      this.steps--;\n    },\n    nextStep: function nextStep() {\n      var _this = this;\n\n      this.$refs['teacher_calendar_form'].validate(function (valid) {\n        if (valid) {\n          _this.steps++;\n\n          if (_this.steps === 1) {\n            _this.$store.commit('update_start_school_year', _this.form.start_school_year);\n\n            _this.$store.commit('update_end_school_year', _this.form.end_school_year);\n\n            _this.$store.commit('update_start_teach_week', _this.form.start_teach_week);\n\n            _this.$store.commit('update_end_teach_week', _this.form.end_teach_week);\n\n            _this.$store.commit('update_is_weekly', _this.form.is_weekly);\n          } else if (_this.steps === 2) {\n            _this.$store.state.weekInfo = _this.$store.getters.getWeekInfo;\n            Bus.$emit('week_num', \"change\");\n            var date = new Date();\n            var year = date.getFullYear();\n            var month = date.getMonth() + 1;\n            var day = date.getDate();\n            var Month = month < 10 ? \"0\" + month : \"\" + month;\n            var Day = day < 10 ? \"0\" + day : day + \"\";\n            _this.NowDate = year + \"-\" + Month + \"-\" + Day;\n          }\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["teacher_calendar.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <el-row type=\"flex\"\r\n            justify=\"center\"\r\n            align=\"middle\"\r\n            style=\"margin-bottom: 20px;flex-direction: column\">\r\n\r\n        <el-row type=\"flex\"\r\n                justify=\"start\"\r\n                align=\"middle\"\r\n                style=\"margin-bottom: 10px;width: 960px;\"\r\n\r\n        >\r\n            <el-row style=\"width: 650px;margin-right: 20px;border-right:1px solid #aaa;padding-right: 0px\">\r\n                <el-steps :active=\"steps\"\r\n                          finish-status=\"success\"\r\n                          :align-center=\"true\"\r\n                >\r\n                    <el-step title=\"填写信息\"></el-step>\r\n                    <el-step title=\"选择课程\"></el-step>\r\n                    <el-step title=\"预览和导出\"></el-step>\r\n                </el-steps>\r\n            </el-row>\r\n            <el-row\r\n                    type=\"flex\"\r\n                    justify=\"start\"\r\n                    style=\"height: 40px\"\r\n            >\r\n                <el-row type=\"flex\" style=\"margin-right: 20px\">\r\n                    <el-button type=\"primary\"\r\n                               @click=\"prevStep\" size=\"small\"\r\n                               icon=\"el-icon-arrow-left\"\r\n                               :disabled=\"steps===0\">上一步\r\n                    </el-button>\r\n                </el-row>\r\n                <el-row\r\n                        type=\"flex\"\r\n                        justify=\"end\"\r\n                >\r\n                    <!--<el-button @click=\"nextStep\" size=\"small\" :disabled=\"steps===2\" v-show=\"steps<2\">下一步</el-button>-->\r\n                    <el-button type=\"success\"\r\n                               @click=\"exportDocx()\"\r\n                               size=\"small\"\r\n                               v-show=\"steps<3\"\r\n                               :disabled=\"steps<2\">导出\r\n                    </el-button>\r\n                </el-row>\r\n            </el-row>\r\n        </el-row>\r\n        <el-row type=\"flex\"\r\n                justify=\"center\"\r\n                style=\"min-height: 200px;margin: 20px auto;border-bottom: 1px solid #aaa\"\r\n        >\r\n            <el-form ref=\"teacher_calendar_form\"\r\n                     :model=\"form\"\r\n                     :rules=\"teacher_calendar_rules\"\r\n                     size=\"mini\"\r\n                     label-position=\"left\"\r\n                     label-width=\"85px\"\r\n                     v-show=\"steps===0\"\r\n\r\n            >\r\n                <el-form-item label=\"学年:\" prop=\"start_school_year\">\r\n                    <el-row type=\"flex\" justify=\"start\">\r\n                        <el-form-item prop=\"start_school_year\">\r\n                            <el-date-picker\r\n                                    v-model=\"form.start_school_year\"\r\n                                    type=\"year\"\r\n                                    format=\"yyyy年\"\r\n                                    value-format=\"yyyy\"\r\n                                    placeholder=\"开始学年\"\r\n                                    @change=\"setEndYear()\"\r\n                            >\r\n                            </el-date-picker>\r\n                        </el-form-item>\r\n                        -\r\n                        <el-form-item prop=\"end_school_year\">\r\n                            <el-date-picker\r\n                                    v-model=\"form.end_school_year\"\r\n                                    type=\"year\"\r\n                                    format=\"yyyy年\"\r\n                                    value-format=\"yyyy\"\r\n                                    placeholder=\"结束学年\">\r\n                            </el-date-picker>\r\n                        </el-form-item>\r\n                    </el-row>\r\n                </el-form-item>\r\n\r\n\r\n                <el-form-item label=\"学期:\" prop=\"term_num\">\r\n                    <template>\r\n                        <el-input-number\r\n                                v-model=\"form.term_num\"\r\n                                :min=\"1\"\r\n                                :max=\"2\"\r\n                                label=\"请输入第几学期\"/>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n                    <el-form-item label=\"课程名称:\" prop=\"course_name\">\r\n                        <el-input v-model=\"form.course_name\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n\r\n                    <el-form-item label=\"课程编码:\" prop=\"course_code\">\r\n                        <el-input v-model=\"form.course_code\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n\r\n                    <el-form-item label=\"课程性质:\" prop=\"course_character\">\r\n                        <el-input v-model=\"form.course_character\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"教师姓名:\" prop=\"teacher_name\">\r\n                        <el-input v-model=\"form.teacher_name\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"专业:\" prop=\"major\">\r\n                        <el-input v-model=\"form.major\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"任课班级:\" prop=\"course_class\">\r\n                        <el-input v-model=\"form.course_class\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-form-item label=\"教学周:\" prop=\"start_teach_week\">\r\n                    <el-row type=\"flex\" justify=\"start\">\r\n                        <el-form-item prop=\"start_teach_week\">\r\n                            <template>\r\n                                <el-input-number v-model=\"form.start_teach_week\" :min=\"1\"\r\n                                                 :max=\"form.end_teach_week\"\r\n                                                 label=\"开始周\"></el-input-number>\r\n                            </template>\r\n                        </el-form-item>\r\n                        -\r\n                        <el-form-item prop=\"end_teach_week\">\r\n\r\n                            <template>\r\n                                <el-input-number v-model=\"form.end_teach_week\" :min=\"form.start_teach_week\"\r\n                                                 :max=\"18\"\r\n                                                 label=\"结束周\"></el-input-number>\r\n                            </template>\r\n                        </el-form-item>\r\n                    </el-row>\r\n                </el-form-item>\r\n                <el-row type=\"flex\" justify=\"space-between\">\r\n                    <el-form-item label=\"上课方案:\">\r\n                        <!--true为每周，false为单双周-->\r\n                        <el-switch\r\n                                v-model=\"form.is_weekly\"\r\n                                active-text=\"每周\"\r\n                                inactive-text=\"单双周\"\r\n                                active-color=\"#13ce66\"\r\n                                inactive-color=\"#ff4949\"\r\n                                :width=\"80\"\r\n                        >\r\n                        </el-switch>\r\n                    </el-form-item>\r\n                </el-row>\r\n            </el-form>\r\n            <course_select v-show=\"steps===1\"></course_select>\r\n            <preview v-show=\"steps===2\" :form=\"form\" :NowDate=\"NowDate\"></preview>\r\n\r\n        </el-row>\r\n        <el-row type=\"flex\"\r\n                justify=\"end\"\r\n                style=\"width: 545px;height: 40px;\"\r\n                v-if=\"steps<2\"\r\n        >\r\n            <el-button @click=\"nextStep\"\r\n                       type=\"primary\"\r\n                       size=\"small\"\r\n                       :disabled=\"steps===2\">下一步<i class=\"el-icon-arrow-right el-icon--right\"></i></el-button>\r\n        </el-row>\r\n    </el-row>\r\n</template>\r\n\r\n<script>\r\n    import Vue from \"vue\";\r\n    import {User} from '@/model';\r\n    import course_select from \"../../components/select_course.vue\";\r\n    import preview from \"../../components/preview.vue\"\r\n    import XDoc from \"../../assets/js/xdoc.js\"\r\n    import Bus from '../../assets/js/Bus.js'\r\n\r\n    export default {\r\n\r\n        data() {\r\n            return {\r\n                steps: 0,\r\n                loading: true,\r\n                dialogVisible: false,\r\n                user_id: '',\r\n                currentPage: 1,\r\n                pageSize: 8,\r\n                itemTotal: 0,\r\n                NowDate: \"\",\r\n                form: {\r\n                    start_school_year: \"2018\",\r\n                    end_school_year: \"2019\",\r\n                    term_num: 2,\r\n                    course_name: \"面向对象课程设计\",\r\n                    course_code: \"B014019\",\r\n                    course_character: \"专业选修课\",\r\n                    teacher_name: \"尹天鹤\",\r\n                    major: \"信息与计算科学\",\r\n                    course_class: \"171-1，2\",\r\n                    start_teach_week: 1,\r\n                    end_teach_week: 16,\r\n                    is_weekly: true\r\n                },\r\n                teacher_calendar_rules: {\r\n                    start_school_year: [\r\n                        {required: true, message: '请输入开始年份', trigger: 'blur'}\r\n                    ],\r\n                    end_school_year: [\r\n                        {required: true, message: '请输入结束年份', trigger: 'blur'}\r\n                    ],\r\n                    term_num: [\r\n                        {required: true, message: '请输入学期数', trigger: 'blur'}\r\n                    ],\r\n                    course_name: [\r\n                        {required: false, message: '请输入课程名称', trigger: 'blur'}\r\n                    ],\r\n                    course_code: [\r\n                        {required: false, message: '请输入课程编码', trigger: 'blur'}\r\n                    ],\r\n                    course_character: [\r\n                        {required: false, message: '请输入课程性质', trigger: 'blur'}\r\n                    ],\r\n\r\n                    teacher_name: [\r\n                        {required: false, message: '请输入教师名称', trigger: 'blur'}\r\n                    ],\r\n                    major: [\r\n                        {required: false, message: '请输入专业', trigger: 'blur'}\r\n                    ],\r\n                    course_class: [\r\n                        {required: false, message: '请输入任课班级', trigger: 'blur'}\r\n                    ],\r\n                    start_teach_week: [\r\n                        {required: true, message: '请输入教学开始周', trigger: 'blur'}\r\n                    ],\r\n                    end_teach_week: [\r\n                        {required: true, message: '请输入教学结束周', trigger: 'blur'}\r\n                    ]\r\n\r\n                }\r\n            }\r\n        },\r\n        components: {\r\n            course_select,\r\n            preview\r\n        },\r\n        methods: {\r\n            exportDocx() {\r\n                let table = \"周次,月.日,讲课内容分章、分节名称,时数,实验、讨论课、习题课等环节名称,时数,作业\\n\";\r\n                this.$store.state.weekInfo.forEach((val) => {\r\n                    table = table + val.weekNum + \",\" + val.classDay + \"\\n\";\r\n                });\r\n                const params = {\r\n                    _filename: this.form.teacher_name + \"-\" + this.form.course_name + \"-教学日历\",\r\n                    \"course_name\": this.form.course_name,\r\n                    \"course_code\": this.form.course_code,\r\n                    \"course_character\": this.form.course_character,\r\n                    \"major\": this.form.major,\r\n                    \"class\": this.form.course_class,\r\n                    \"start_school_year\": this.form.start_school_year,\r\n                    \"end_school_year\": this.form.end_school_year,\r\n                    \"term_num\": this.form.term_num,\r\n                    \"teacher_name\": this.form.teacher_name,\r\n                    \"date\": this.NowDate,\r\n                    \"list\": \"教学周数,讲课,实验等,机动,合计,培养方案\\n\" + (this.form.end_teach_week - this.form.start_teach_week + 1) + \"周,,,,,\",\r\n                    \"table\": table\r\n                };\r\n                this.steps++;\r\n                XDoc.server = \"http://www.xdocin.com\";\r\n                XDoc.key = \"3vxgddieardwtmzuadxxavx4ha\";\r\n                XDoc.run(\"./yintianhe.xdoc\",\r\n                    \"docx\",\r\n                    params,\r\n                    \"_blank\");\r\n\r\n                this.$message({\r\n                    message: '导出成功',\r\n                    type: 'success'\r\n                });\r\n\r\n            },\r\n            setEndYear() {\r\n                this.form.end_school_year = parseInt(this.form.start_school_year) + 1 + \"\";\r\n            },\r\n            prevStep() {\r\n                this.steps--;\r\n            },\r\n            nextStep() {\r\n                this.$refs['teacher_calendar_form'].validate((valid) => {\r\n                    if (valid) {\r\n                        this.steps++;\r\n                        if (this.steps === 1) {\r\n                            this.$store.commit('update_start_school_year', this.form.start_school_year);\r\n                            this.$store.commit('update_end_school_year', this.form.end_school_year);\r\n                            this.$store.commit('update_start_teach_week', this.form.start_teach_week);\r\n                            this.$store.commit('update_end_teach_week', this.form.end_teach_week);\r\n                            this.$store.commit('update_is_weekly', this.form.is_weekly);\r\n\r\n                        } else if (this.steps === 2) {\r\n                            this.$store.state.weekInfo = this.$store.getters.getWeekInfo;\r\n                            Bus.$emit('week_num', \"change\")\r\n                            let date = new Date();\r\n                            let year = date.getFullYear();\r\n                            let month = date.getMonth() + 1;\r\n                            let day = date.getDate();\r\n                            const Month = month < 10 ? \"0\" + month : \"\" + month;\r\n                            const Day = day < 10 ? \"0\" + day : day + \"\";\r\n                            this.NowDate = year + \"-\" + Month + \"-\" + Day;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .col-title {\r\n        text-align: left;\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .title {\r\n        font-size: 14px;\r\n        font-weight: bolder;\r\n    }\r\n\r\n    /*.header{*/\r\n    /*color:#409EFF;*/\r\n    /*}*/\r\n    /*.title{*/\r\n    /*color:#fff;*/\r\n    /*font-size: 28px;*/\r\n    /*font-weight: 600;*/\r\n    /*padding-left: 80px;*/\r\n    /*background-color: #409EFF;*/\r\n    /*}*/\r\n    /*.sort{*/\r\n    /*color: #409EFF;*/\r\n    /*padding-left: 100px;*/\r\n    /*}*/\r\n</style>\r\n"],"sourceRoot":"src\\views\\teacher_calendar"}]}