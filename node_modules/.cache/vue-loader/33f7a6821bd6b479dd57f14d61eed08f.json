{"remainingRequest":"G:\\vue\\Admin\\teacher_platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\vue\\Admin\\teacher_platform\\src\\views\\teacher_calendar\\teacher_calendar.vue?vue&type=script&lang=ts&","dependencies":[{"path":"G:\\vue\\Admin\\teacher_platform\\src\\views\\teacher_calendar\\teacher_calendar.vue","mtime":1551017253291},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1545539497453},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\ts-loader\\index.js","mtime":1546150480400},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1545539517045},{"path":"G:\\vue\\Admin\\teacher_platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1545539518738}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\nimport {User} from '@/model';\nimport Component from \"vue-class-component\";\nimport course_select from \"../../components/select_course.vue\";\nimport preview from \"../../components/preview.vue\"\nimport XDoc from \"../../assets/js/Xdoc.js\";\n\ninterface Form {\n    start_school_year: any,\n    end_school_year: any,\n    term_num: number,\n    course_name: string,\n    course_code: string,\n    course_character: string,\n    teacher_name: string,\n    major: string,\n    course_class: string,\n    start_teach_week: number,\n    end_teach_week: number,\n    is_weekly: boolean\n}\n\n@Component({\n    data() {\n        return {\n            steps: 0,\n            loading: true,\n            dialogVisible: false,\n            user_id: '',\n            currentPage: 1,\n            pageSize: 8,\n            itemTotal: 0,\n            NowDate: \"\",\n            form: {\n                start_school_year: \"2019\",\n                end_school_year: \"2020\",\n                term_num: 1,\n                course_name: \"面向对象课程设计\",\n                course_code: \"B014019\",\n                course_character: \"专业选修课\",\n                teacher_name: \"尹天鹤\",\n                major: \"信息与计算科学\",\n                course_class: \"171-1，2\",\n                start_teach_week: 1,\n                end_teach_week: 16,\n                is_weekly: true\n            }\n        }\n    },\n    components: {\n        course_select,\n        preview\n    },\n    methods: {\n        exportDocx() {\n            let table = \"周次,月.日,讲课内容分章、分节名称,时数,实验、讨论课、习题课等环节名称,时数,作业\\n\";\n            this.$store.state.weekInfo.forEach((val) => {\n                table = table + val.weekNum + \",\" + val.classDay + \"\\n\";\n            });\n            const params = {\n                \"course_name\": this.form.course_name,\n                \"course_code\": this.form.course_code,\n                \"course_character\": this.form.course_character,\n                \"major\": this.form.major,\n                \"class\": this.form.course_class,\n                \"start_school_year\": this.form.start_school_year,\n                \"end_school_year\": this.form.end_school_year,\n                \"term_num\": this.form.term_num,\n                \"teacher_name\": this.form.teacher_name,\n                \"date\": this.form.NowDate,\n                \"list\": \"教学周数,讲课,实验等,机动,合计,培养方案\\n\" + (this.form.end_teach_week - this.form.start_teach_week) + \"周,,,,,\",\n                \"table\": table\n            };\n            this.steps++;\n            XDoc.server = \"http://www.xdocin.com\";\n            XDoc.key = \"3vxgddieardwtmzuadxxavx4ha\";\n            XDoc.run(\"./yintianhe.xdoc\",\n                \"docx\",\n                params,\n                \"_blank\");\n\n            this.$message({\n                message: '导出成功',\n                type: 'success'\n            });\n\n        },\n        prevStep() {\n            this.steps--;\n        },\n        nextStep() {\n            this.$refs['teacher_calendar_form'].validate((valid) => {\n                if (valid) {\n                    this.steps++;\n                    if (this.steps === 1) {\n                        this.$store.commit('update_start_school_year', this.form.start_school_year);\n                        this.$store.commit('update_end_school_year', this.form.end_school_year);\n                        this.$store.commit('update_start_teach_week', this.form.start_teach_week);\n                        this.$store.commit('update_end_teach_week', this.form.end_teach_week);\n                        this.$store.commit('update_is_weekly', this.form.is_weekly);\n\n                    } else if (this.steps === 2) {\n                        this.$store.state.weekInfo = this.$store.getters.getWeekInfo;\n                        let date = new Date();\n                        let year = date.getFullYear();\n                        let month = date.getMonth() + 1;\n                        let day = date.getDate();\n                        const Month = month < 10 ? \"0\" + month : \"\" + month;\n                        const Day = day < 10 ? \"0\" + day : day + \"\";\n                        this.NowDate = year + \"-\" + Month + \"-\" + Day;\n                    }\n                }\n            });\n        }\n    }\n})\nexport default class TeacherCalendar extends Vue {\n    // data\n    teacher_calendar_rules: any = {\n        start_school_year: [\n            {required: true, message: '请输入开始年份', trigger: 'blur'}\n        ],\n        end_school_year: [\n            {required: true, message: '请输入结束年份', trigger: 'blur'}\n        ],\n        term_num: [\n            {required: true, message: '请输入学期数', trigger: 'blur'}\n        ],\n        course_name: [\n            {required: true, message: '请输入课程名称', trigger: 'blur'}\n        ],\n        course_code: [\n            {required: true, message: '请输入课程编码', trigger: 'blur'}\n        ],\n        course_character: [\n            {required: true, message: '请输入课程性质', trigger: 'blur'}\n        ],\n\n        teacher_name: [\n            {required: true, message: '请输入教师名称', trigger: 'blur'}\n        ],\n        major: [\n            {required: true, message: '请输入专业', trigger: 'blur'}\n        ],\n        course_class: [\n            {required: true, message: '请输入任课班级', trigger: 'blur'}\n        ],\n        start_teach_week: [\n            {required: true, message: '请输入教学开始周', trigger: 'blur'}\n        ],\n        end_teach_week: [\n            {required: true, message: '请输入教学结束周', trigger: 'blur'}\n        ]\n\n    };\n    // $refs\n    public $refs!: {\n        validate: HTMLFormElement\n    };\n\n    // methods\n\n    // created\n    private created(): void {\n        // this.loading = false;\n        // let date = new Date();\n        // console.log(date.getTime() + 3600 * 1000 * 365 * 24);\n    }\n\n}\n",{"version":3,"sources":["teacher_calendar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4JA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"teacher_calendar.vue","sourceRoot":"src\\views\\teacher_calendar","sourcesContent":["<template>\r\n    <el-col type=\"flex\">\r\n        <el-row type=\"flex\"\r\n                justify=\"start\"\r\n                align=\"middle\"\r\n                style=\"margin-bottom: 20px;width: 960px;\"\r\n\r\n        >\r\n            <el-row style=\"width: 650px;margin-right: 20px;border-right:1px solid #aaa;padding-right: 0px\">\r\n                <el-steps :active=\"steps\"\r\n                          finish-status=\"success\"\r\n                          :align-center=\"true\"\r\n                >\r\n                    <el-step title=\"填写信息\"></el-step>\r\n                    <el-step title=\"选择课程\"></el-step>\r\n                    <el-step title=\"预览和导出\"></el-step>\r\n                </el-steps>\r\n            </el-row>\r\n            <el-row\r\n                    type=\"flex\"\r\n                    justify=\"start\"\r\n                    style=\"height: 40px\"\r\n            >\r\n                <el-row type=\"flex\" style=\"margin-right: 20px\">\r\n                    <el-button @click=\"prevStep\" size=\"small\" :disabled=\"steps===0\">上一步</el-button>\r\n                </el-row>\r\n                <el-row\r\n                        type=\"flex\"\r\n                        justify=\"end\"\r\n                >\r\n                    <el-button @click=\"nextStep\" size=\"small\" :disabled=\"steps===2\" v-show=\"steps<2\">下一步</el-button>\r\n                    <el-button type=\"success\" @click=\"exportDocx()\" size=\"small\" v-show=\"steps===2\">导出</el-button>\r\n                </el-row>\r\n            </el-row>\r\n        </el-row>\r\n        <el-row type=\"flex\"\r\n                justify=\"center\"\r\n                style=\"min-height: 400px;margin: 0 auto\"\r\n        >\r\n            <el-form ref=\"teacher_calendar_form\"\r\n                     :model=\"form\"\r\n                     :rules=\"teacher_calendar_rules\"\r\n                     size=\"mini\"\r\n                     label-position=\"left\"\r\n                     label-width=\"85px\"\r\n                     v-show=\"steps===0\"\r\n\r\n            >\r\n                <el-form-item label=\"学年:\" prop=\"start_school_year\">\r\n                    <el-row type=\"flex\" justify=\"start\">\r\n                        <el-form-item prop=\"start_school_year\">\r\n                            <el-date-picker\r\n                                    v-model=\"form.start_school_year\"\r\n                                    type=\"year\"\r\n                                    format=\"yyyy年\"\r\n                                    value-format=\"yyyy\"\r\n                                    placeholder=\"开始学年\"\r\n                            >\r\n                            </el-date-picker>\r\n                        </el-form-item>\r\n                        -\r\n                        <el-form-item prop=\"end_school_year\">\r\n                            <el-date-picker\r\n                                    v-model=\"form.end_school_year\"\r\n                                    type=\"year\"\r\n                                    format=\"yyyy年\"\r\n                                    value-format=\"yyyy\"\r\n                                    placeholder=\"结束学年\">\r\n                            </el-date-picker>\r\n                        </el-form-item>\r\n                    </el-row>\r\n                </el-form-item>\r\n\r\n\r\n                <el-form-item label=\"学期:\" prop=\"term_num\">\r\n                    <template>\r\n                        <el-input-number\r\n                                v-model=\"form.term_num\"\r\n                                :min=\"1\"\r\n                                :max=\"2\"\r\n                                label=\"请输入第几学期\"/>\r\n                    </template>\r\n                </el-form-item>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n                    <el-form-item label=\"课程名称:\" prop=\"course_name\">\r\n                        <el-input v-model=\"form.course_name\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n\r\n                    <el-form-item label=\"课程编码:\" prop=\"course_code\">\r\n                        <el-input v-model=\"form.course_code\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 800px\">\r\n\r\n                    <el-form-item label=\"课程性质:\" prop=\"course_character\">\r\n                        <el-input v-model=\"form.course_character\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"教师姓名:\" prop=\"teacher_name\">\r\n                        <el-input v-model=\"form.teacher_name\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"专业:\" prop=\"major\">\r\n                        <el-input v-model=\"form.major\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-row type=\"flex\" justify=\"space-between\" style=\"width: 600px\">\r\n                    <el-form-item label=\"任课班级:\" prop=\"course_class\">\r\n                        <el-input v-model=\"form.course_class\" placeholder=\"\"/>\r\n                    </el-form-item>\r\n                </el-row>\r\n                <el-form-item label=\"教学周:\" prop=\"start_teach_week\">\r\n                    <el-row type=\"flex\" justify=\"start\">\r\n                        <el-form-item prop=\"start_teach_week\">\r\n                            <template>\r\n                                <el-input-number v-model=\"form.start_teach_week\" :min=\"1\"\r\n                                                 :max=\"form.end_teach_week\"\r\n                                                 label=\"开始周\"></el-input-number>\r\n                            </template>\r\n                        </el-form-item>\r\n                        -\r\n                        <el-form-item prop=\"end_teach_week\">\r\n\r\n                            <template>\r\n                                <el-input-number v-model=\"form.end_teach_week\" :min=\"form.start_teach_week\"\r\n                                                 :max=\"18\"\r\n                                                 label=\"结束周\"></el-input-number>\r\n                            </template>\r\n                        </el-form-item>\r\n                    </el-row>\r\n                </el-form-item>\r\n                <el-row type=\"flex\" justify=\"space-between\">\r\n                    <el-form-item label=\"上课方案:\">\r\n                        <!--true为每周，false为单双周-->\r\n                        <el-switch\r\n                                v-model=\"form.is_weekly\"\r\n                                active-text=\"每周\"\r\n                                inactive-text=\"单双周\"\r\n                                active-color=\"#13ce66\"\r\n                                inactive-color=\"#ff4949\"\r\n                        >\r\n                        </el-switch>\r\n                    </el-form-item>\r\n                </el-row>\r\n            </el-form>\r\n            <course_select v-show=\"steps===1\"></course_select>\r\n            <preview v-show=\"steps===2\" :form=\"form\" :NowDate=\"NowDate\"></preview>\r\n        </el-row>\r\n    </el-col>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n    import Vue from \"vue\";\r\n    import {User} from '@/model';\r\n    import Component from \"vue-class-component\";\r\n    import course_select from \"../../components/select_course.vue\";\r\n    import preview from \"../../components/preview.vue\"\r\n    import XDoc from \"../../assets/js/Xdoc.js\";\r\n\r\n    interface Form {\r\n        start_school_year: any,\r\n        end_school_year: any,\r\n        term_num: number,\r\n        course_name: string,\r\n        course_code: string,\r\n        course_character: string,\r\n        teacher_name: string,\r\n        major: string,\r\n        course_class: string,\r\n        start_teach_week: number,\r\n        end_teach_week: number,\r\n        is_weekly: boolean\r\n    }\r\n\r\n    @Component({\r\n        data() {\r\n            return {\r\n                steps: 0,\r\n                loading: true,\r\n                dialogVisible: false,\r\n                user_id: '',\r\n                currentPage: 1,\r\n                pageSize: 8,\r\n                itemTotal: 0,\r\n                NowDate: \"\",\r\n                form: {\r\n                    start_school_year: \"2019\",\r\n                    end_school_year: \"2020\",\r\n                    term_num: 1,\r\n                    course_name: \"面向对象课程设计\",\r\n                    course_code: \"B014019\",\r\n                    course_character: \"专业选修课\",\r\n                    teacher_name: \"尹天鹤\",\r\n                    major: \"信息与计算科学\",\r\n                    course_class: \"171-1，2\",\r\n                    start_teach_week: 1,\r\n                    end_teach_week: 16,\r\n                    is_weekly: true\r\n                }\r\n            }\r\n        },\r\n        components: {\r\n            course_select,\r\n            preview\r\n        },\r\n        methods: {\r\n            exportDocx() {\r\n                let table = \"周次,月.日,讲课内容分章、分节名称,时数,实验、讨论课、习题课等环节名称,时数,作业\\n\";\r\n                this.$store.state.weekInfo.forEach((val) => {\r\n                    table = table + val.weekNum + \",\" + val.classDay + \"\\n\";\r\n                });\r\n                const params = {\r\n                    \"course_name\": this.form.course_name,\r\n                    \"course_code\": this.form.course_code,\r\n                    \"course_character\": this.form.course_character,\r\n                    \"major\": this.form.major,\r\n                    \"class\": this.form.course_class,\r\n                    \"start_school_year\": this.form.start_school_year,\r\n                    \"end_school_year\": this.form.end_school_year,\r\n                    \"term_num\": this.form.term_num,\r\n                    \"teacher_name\": this.form.teacher_name,\r\n                    \"date\": this.form.NowDate,\r\n                    \"list\": \"教学周数,讲课,实验等,机动,合计,培养方案\\n\" + (this.form.end_teach_week - this.form.start_teach_week) + \"周,,,,,\",\r\n                    \"table\": table\r\n                };\r\n                this.steps++;\r\n                XDoc.server = \"http://www.xdocin.com\";\r\n                XDoc.key = \"3vxgddieardwtmzuadxxavx4ha\";\r\n                XDoc.run(\"./yintianhe.xdoc\",\r\n                    \"docx\",\r\n                    params,\r\n                    \"_blank\");\r\n\r\n                this.$message({\r\n                    message: '导出成功',\r\n                    type: 'success'\r\n                });\r\n\r\n            },\r\n            prevStep() {\r\n                this.steps--;\r\n            },\r\n            nextStep() {\r\n                this.$refs['teacher_calendar_form'].validate((valid) => {\r\n                    if (valid) {\r\n                        this.steps++;\r\n                        if (this.steps === 1) {\r\n                            this.$store.commit('update_start_school_year', this.form.start_school_year);\r\n                            this.$store.commit('update_end_school_year', this.form.end_school_year);\r\n                            this.$store.commit('update_start_teach_week', this.form.start_teach_week);\r\n                            this.$store.commit('update_end_teach_week', this.form.end_teach_week);\r\n                            this.$store.commit('update_is_weekly', this.form.is_weekly);\r\n\r\n                        } else if (this.steps === 2) {\r\n                            this.$store.state.weekInfo = this.$store.getters.getWeekInfo;\r\n                            let date = new Date();\r\n                            let year = date.getFullYear();\r\n                            let month = date.getMonth() + 1;\r\n                            let day = date.getDate();\r\n                            const Month = month < 10 ? \"0\" + month : \"\" + month;\r\n                            const Day = day < 10 ? \"0\" + day : day + \"\";\r\n                            this.NowDate = year + \"-\" + Month + \"-\" + Day;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    })\r\n    export default class TeacherCalendar extends Vue {\r\n        // data\r\n        teacher_calendar_rules: any = {\r\n            start_school_year: [\r\n                {required: true, message: '请输入开始年份', trigger: 'blur'}\r\n            ],\r\n            end_school_year: [\r\n                {required: true, message: '请输入结束年份', trigger: 'blur'}\r\n            ],\r\n            term_num: [\r\n                {required: true, message: '请输入学期数', trigger: 'blur'}\r\n            ],\r\n            course_name: [\r\n                {required: true, message: '请输入课程名称', trigger: 'blur'}\r\n            ],\r\n            course_code: [\r\n                {required: true, message: '请输入课程编码', trigger: 'blur'}\r\n            ],\r\n            course_character: [\r\n                {required: true, message: '请输入课程性质', trigger: 'blur'}\r\n            ],\r\n\r\n            teacher_name: [\r\n                {required: true, message: '请输入教师名称', trigger: 'blur'}\r\n            ],\r\n            major: [\r\n                {required: true, message: '请输入专业', trigger: 'blur'}\r\n            ],\r\n            course_class: [\r\n                {required: true, message: '请输入任课班级', trigger: 'blur'}\r\n            ],\r\n            start_teach_week: [\r\n                {required: true, message: '请输入教学开始周', trigger: 'blur'}\r\n            ],\r\n            end_teach_week: [\r\n                {required: true, message: '请输入教学结束周', trigger: 'blur'}\r\n            ]\r\n\r\n        };\r\n        // $refs\r\n        public $refs!: {\r\n            validate: HTMLFormElement\r\n        };\r\n\r\n        // methods\r\n\r\n        // created\r\n        private created(): void {\r\n            // this.loading = false;\r\n            // let date = new Date();\r\n            // console.log(date.getTime() + 3600 * 1000 * 365 * 24);\r\n        }\r\n\r\n    }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .col-title {\r\n        text-align: left;\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .title {\r\n        font-size: 14px;\r\n        font-weight: bolder;\r\n    }\r\n\r\n    /*.header{*/\r\n    /*color:#409EFF;*/\r\n    /*}*/\r\n    /*.title{*/\r\n    /*color:#fff;*/\r\n    /*font-size: 28px;*/\r\n    /*font-weight: 600;*/\r\n    /*padding-left: 80px;*/\r\n    /*background-color: #409EFF;*/\r\n    /*}*/\r\n    /*.sort{*/\r\n    /*color: #409EFF;*/\r\n    /*padding-left: 100px;*/\r\n    /*}*/\r\n</style>\r\n"]}]}